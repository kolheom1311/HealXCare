{% load static %}
<!DOCTYPE html>
<html lang="en">
<!-- doccure/profile-settings.html  30 Nov 2019 04:12:18 GMT -->

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0" />
  <title>HealXCare</title>

  <!-- Favicons -->
  <link type="image/x-icon" href="{% static 'HealthStack-System/images/Normal/favicon.png' %}" rel="icon" />

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="{% static 'HealthStack-System/css/Normal/bootstrap.min.css' %}" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
  <!-- Added now -->

  <!-- Fontawesome CSS -->
  <link rel="stylesheet" href="{% static 'HealthStack-System/plugins/Normal/fontawesome/css/fontawesome.min.css' %}" />
  <link rel="stylesheet" href="{% static 'HealthStack-System/plugins/Normal/fontawesome/css/all.min.css' %}" />

  <!-- Datetimepicker CSS -->
  <link rel="stylesheet" href="{% static 'HealthStack-System/css/Normal/bootstrap-datetimepicker.min.css' %}" />

  <!-- Select2 CSS -->
  <link rel="stylesheet" href="{% static 'HealthStack-System/plugins/Normal/select2/css/select2.min.css' %}" />

  <!-- Main CSS -->
  <link rel="stylesheet" href="{% static 'HealthStack-System/css/Normal/style.css' %}" />

  <link href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" rel="stylesheet" />

  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="assets/js/html5shiv.min.js"></script>
      <script src="assets/js/respond.min.js"></script>
    <![endif]-->
  <style>
    /* Ensure no underline on navbar links */
    .navbar a {
      text-decoration: none !important;
    }

    /* Remove underline on hover as well */
    .navbar a:hover {
      text-decoration: none !important;
    }

    input[readonly] {
      background-color: #e9ecef !important;
      opacity: 1;
    }
  </style>
</head>

<body>
  <!-- Main Wrapper -->
  <div class="main-wrapper">
    <!-- Header -->
    <header class="header">{% include 'patient_navbar.html' %}</header>
    <!-- /Header -->

    <!-- Breadcrumb -->
    <div class="breadcrumb-bar">
      <div class="container-fluid">
        <div class="row align-items-center">
          <div class="col-md-12 col-12">
            <nav aria-label="breadcrumb" class="page-breadcrumb">
              <ol class="breadcrumb">
                {% if patient.profile_completed %}
                <li class="breadcrumb-item"><a href="{% url 'patient-dashboard' %}">Home</a></li>
                <li class="breadcrumb-item active" aria-current="page">
                  Profile Settings
                </li>
                {% endif %}
              </ol>
            </nav>
            <div style="display: flex; gap: 50px; flex-wrap: wrap;">
              <h2 class="breadcrumb-title">Profile Settings</h2>
              {% include 'message.html' %}
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- /Breadcrumb -->

    <!-- Page Content -->
    <div class="content">
      <div class="container-fluid">
        <div class="row">
          <!-- Profile Sidebar -->
          <div class="col-md-5 col-lg-4 col-xl-3 theiaStickySidebar">
            <div>{% include 'patient-sidebar.html' %}</div>
          </div>
          <!-- /Profile Sidebar -->


          <div class="col-md-7 col-lg-8 col-xl-9">
            <div class="card">
              <div class="card-body">

                <!-- Profile Settings Form -->
                <!-- <form action="{% url 'profile-settings' %}" method="POST" enctype="multipart/form-data">
                  {% csrf_token %}
                  <div class="row form-row">
                    <div class="col-12 col-md-12">
                      <div class="form-group">
                        <div class="change-avatar">
                          <div class="profile-img">
                            <img src="{{patient.featured_image.url}}" alt="User Image">
                          </div>
                          <div class="upload-img">
                            <div class="change-photo-btn">
                              <span><i class="fa fa-upload"></i> Upload Photo</span>
                              <input type="file" class="upload" name="featured_image">
                            </div>
                            <small class="form-text text-muted">Allowed JPG, GIF or PNG. Max size of 2MB</small>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="row g-3">
                      <div class="col-md-6">
                        <label class="form-label">Username</label>
                        <input type="text" class="form-control" readonly value="{{patient.username}}">
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Email</label>
                        <input type="text" class="form-control" readonly value="{{patient.email}}">
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Name</label>
                        <input type="text" class="form-control" value="{{ patient.name }}" name="name">
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Date of Birth</label>
                        <input type="date" class="form-control" value="{{patient.dob}}" name="dob" id="dobPicker">
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Blood Group</label>
                        <select class="form-select" name="blood_group">
                          <option value="{{patient.blood_group}}">{{patient.blood_group}}</option>
                          <option value="A-">A-</option>
                          <option value="A+">A+</option>
                          <option value="B-">B-</option>
                          <option value="B+">B+</option>
                          <option value="AB-">AB-</option>
                          <option value="AB+">AB+</option>
                          <option value="O-">O-</option>
                          <option value="O+">O+</option>
                        </select>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Mobile</label>
                        <input type="text" value="{{patient.phone_number}}" class="form-control" name="phone_number">
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Address</label>
                        <input type="text" class="form-control" value="{{patient.address}}" name="address">
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Age</label>
                        <input type="text" class="form-control"
                          value="{% if patient.age %}{{ patient.age }}{% else %}To be calculated{% endif %}" name="age"
                          readonly>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Patient ID</label>
                        <input type="text" class="form-control" value="{{patient.patient_id}}" readonly>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">History</label>
                        <div class="input-group">
                          <textarea class="form-control" name="history" rows="5"
                            placeholder="Enter patient history...">{{ patient.history }}</textarea>
                          <button type="button" class="btn btn-outline-secondary" title="Attach File">
                            <i class="bi bi-paperclip"></i>
                            <input type="file" name="attachment" class="d-none"
                              onchange="this.parentElement.classList.add('btn-success')">
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="submit-section mt-3">
                      <button type="submit" class="btn btn-primary">Save Changes</button>
                    </div>
                </form> -->
                <!-- /Profile Settings Form -->
                <form action="{% url 'profile-settings' %}" method="POST" enctype="multipart/form-data">
                  {% csrf_token %}
                  <div class="row form-row">
                    <!-- Profile Image Upload Section -->
                    <div class="col-12 col-md-12">
                      <div class="form-group">
                        <div class="change-avatar">
                          <div class="profile-img">
                            <img src="{{ patient.featured_image.url }}" alt="User Image">
                          </div>
                          <div class="upload-img">
                            <div class="change-photo-btn">
                              <span><i class="fa fa-upload"></i> Upload Photo</span>
                              <input type="file" class="upload" name="featured_image" accept=".jpg,.jpeg,.png,.gif">
                            </div>
                            <small class="form-text text-muted">Allowed JPG, GIF, or PNG. Max size of 2MB</small>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- Patient Information Fields -->
                    <div class="row g-3">
                      <div class="col-md-6">
                        <label class="form-label">Username</label>
                        <input type="text" class="form-control" readonly value="{{ patient.username }}">
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Email</label>
                        <input type="text" class="form-control" readonly value="{{ patient.email }}">
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Name</label>
                        <input type="text" class="form-control" value="{{ patient.name }}" name="name" required>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Date of Birth</label>
                        <input type="date" class="form-control" value="{{ patient.dob }}" name="dob" id="dobPicker"
                          required>
                      </div>
                      <div class="col-md-6">
                        <div class="form-group">
                          <label>Gender<span class="text-danger"
                              style="user-select: none">*</span></label>
                          <select class="form-control select" name="gender">
                            {% if patient.gender == 'male' %}
                            <option value="{{patient.gender}}">{{patient.gender}}</option>
                            <option value="female">Female</option>
                            {% elif patient.gender == 'female' %}
                            <option value="{{patient.gender}}">{{patient.gender}}</option>
                            <option value="male">Male</option>
                            {% else %}
                            <option>Select</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            {% endif %}
  
                          </select>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Blood Group</label>
                        <select class="form-select" name="blood_group">
                          <option value="{{ patient.blood_group }}">{{ patient.blood_group }}</option>
                          <option value="A-">A-</option>
                          <option value="A+">A+</option>
                          <option value="B-">B-</option>
                          <option value="B+">B+</option>
                          <option value="AB-">AB-</option>
                          <option value="AB+">AB+</option>
                          <option value="O-">O-</option>
                          <option value="O+">O+</option>
                        </select>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Mobile</label>
                        <input type="text" value="{{ patient.phone_number }}" class="form-control" name="phone_number"
                          required>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Address</label>
                        <input type="text" class="form-control" value="{{ patient.address }}" name="address" required>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Age</label>
                        <input type="text" class="form-control"
                          value="{% if patient.age %}{{ patient.age }}{% else %}To be calculated{% endif %}" name="age"
                          readonly>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">Patient ID</label>
                        <input type="text" class="form-control" value="{{ patient.patient_id }}" readonly>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label">History</label>
                        <div class="input-group">
                          <textarea class="form-control" name="history" rows="5"
                            placeholder="Enter patient history...">{{ patient.history }}</textarea>
                          <button type="button" class="btn btn-outline-secondary" title="Attach File"
                            onclick="document.getElementById('fileInput').click();">
                            <i class="bi bi-paperclip"></i>
                          </button>
                          <input type="file" name="attachments" id="fileInput" class="d-none" accept=".jpg,.jpeg,.png"
                            multiple>
                        </div>
                      </div>

                      <div class="col-md-6">
                        <label class="form-label">Uploaded Images</label>
                        <div class="mt-2">
                          {% if uploaded_files %}
                          <div class="d-flex flex-wrap">
                            {% for file_path in uploaded_files %}
                            <div class="m-2 position-relative" style="display: inline-block;">
                              <a href="{{ file_path }}" data-fancybox="gallery" target="_blank">
                                <img src="{{ file_path }}" alt="Image" class="img-thumbnail"
                                  style="width: 100px; height: 100px; object-fit: cover;">
                              </a>
                              <button type="button" class="btn btn-danger btn-sm rounded-circle position-absolute"
                                style="top: -5px; right: -5px; z-index: 10;"
                                onclick="markForDeletion(this, '{{ file_path }}')">
                                <i class="bi bi-x"></i>
                              </button>
                            </div>
                            {% endfor %}
                          </div>
                          {% else %}
                          <p>No images uploaded.</p>
                          {% endif %}
                        </div>
                      </div>
                      <!-- Submit Button -->
                      <div class="submit-section mt-3">
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                      </div>
                    </div>
                </form>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
    <!-- /Page Content -->

    <!-- Footer -->
    {% include 'footer.html' %}
    <!-- /Footer -->
  </div>
  <!-- /Main Wrapper -->
  <!-- jQuery -->
  <script src="{% static 'HealthStack-System/js/Normal/jquery.min.js' %}"></script>

  <!-- Bootstrap Core JS -->
  <script src="{% static 'HealthStack-System/js/Normal/popper.min.js' %}"></script>
  <script src="{% static 'HealthStack-System/js/Normal/bootstrap.min.js' %}"></script>

  <script>
    function markForDeletion(button, filePath) {
      const hiddenInput = document.createElement('input');
      hiddenInput.type = 'hidden';
      hiddenInput.name = 'delete_files';
      hiddenInput.value = filePath;
      button.parentElement.appendChild(hiddenInput);
      button.parentElement.style.display = 'none';
    }
  </script>

  <!-- Select2 JS -->
  <script src="{% static 'HealthStack-System/plugins/Normal/select2/js/select2.min.js' %}"></script>

  <!-- Datetimepicker JS -->
  <script src="{% static 'HealthStack-System/js/Normal/moment.min.js' %}"></script>
  <script src="{% static 'HealthStack-System/js/Normal/bootstrap-datetimepicker.min.js' %}"></script>

  <!-- Sticky Sidebar JS -->
  <script src="{% static 'HealthStack-System/plugins/Normal/theia-sticky-sidebar/ResizeSensor.js' %}"></script>
  <script src="{% static 'HealthStack-System/plugins/Normal/theia-sticky-sidebar/theia-sticky-sidebar.js' %}"></script>

  <!-- Custom JS -->
  <script src="{% static 'HealthStack-System/Outside_assets/js/script.js' %}"></script>

  {% if messages %}
  <script>
    {% for message in messages %}
    $(document).ready(function () {
      $('.toast').toast('show');
    });
    {% endfor %}
  </script>
  {% endif %}

  <!-- Searchbar JS -->
  <script src="{% static 'HealthStack-System/js/Normal/sidebar.js' %}"></script>
  <script>
    document.getElementById('dobPicker').setAttribute('max', new Date().toISOString().split('T')[0]);
  </script>
</body>

<!-- doccure/profile-settings.html  30 Nov 2019 04:12:18 GMT -->

</html>